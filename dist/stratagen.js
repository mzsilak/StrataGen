/*! For license information please see stratagen.js.LICENSE.txt */
(()=>{var e={460:function(e,t){var r,n;r=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},r=!t.document&&!!t.postMessage,n=r&&/blob:/i.test((t.location||{}).protocol),i={},o=0,a={parse:function(r,n){var s=(n=n||{}).dynamicTyping||!1;if(b(s)&&(n.dynamicTypingFunction=s,s={}),n.dynamicTyping=s,n.transform=!!b(n.transform)&&n.transform,n.worker&&a.WORKERS_SUPPORTED){var u=function(){if(!a.WORKERS_SUPPORTED)return!1;var r,n,s=(r=t.URL||t.webkitURL||null,n=e.toString(),a.BLOB_URL||(a.BLOB_URL=r.createObjectURL(new Blob(["(",n,")();"],{type:"text/javascript"})))),u=new t.Worker(s);return u.onmessage=v,u.id=o++,i[u.id]=u}();return u.userStep=n.step,u.userChunk=n.chunk,u.userComplete=n.complete,u.userError=n.error,n.step=b(n.step),n.chunk=b(n.chunk),n.complete=b(n.complete),n.error=b(n.error),delete n.worker,void u.postMessage({input:r,config:n,workerId:u.id})}var d=null;return a.NODE_STREAM_INPUT,"string"==typeof r?d=n.download?new c(n):new f(n):!0===r.readable&&b(r.read)&&b(r.on)?d=new h(n):(t.File&&r instanceof File||r instanceof Object)&&(d=new l(n)),d.stream(r)},unparse:function(e,t){var r=!1,n=!0,i=",",o="\r\n",s='"',u=s+s,c=!1,l=null,f=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(i=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(r=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(c=t.skipEmptyLines),"string"==typeof t.newline&&(o=t.newline),"string"==typeof t.quoteChar&&(s=t.quoteChar),"boolean"==typeof t.header&&(n=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");l=t.columns}void 0!==t.escapeChar&&(u=t.escapeChar+s),"boolean"==typeof t.escapeFormulae&&(f=t.escapeFormulae)}}();var h=new RegExp(p(s),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return d(null,e,c);if("object"==typeof e[0])return d(l||Object.keys(e[0]),e,c)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),d(e.fields||[],e.data||[],c);throw new Error("Unable to serialize unrecognized input");function d(e,t,r){var a="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var s=Array.isArray(e)&&0<e.length,u=!Array.isArray(t[0]);if(s&&n){for(var c=0;c<e.length;c++)0<c&&(a+=i),a+=y(e[c],c);0<t.length&&(a+=o)}for(var l=0;l<t.length;l++){var f=s?e.length:t[l].length,h=!1,d=s?0===Object.keys(t[l]).length:0===t[l].length;if(r&&!s&&(h="greedy"===r?""===t[l].join("").trim():1===t[l].length&&0===t[l][0].length),"greedy"===r&&s){for(var p=[],v=0;v<f;v++){var _=u?e[v]:v;p.push(t[l][_])}h=""===p.join("").trim()}if(!h){for(var g=0;g<f;g++){0<g&&!d&&(a+=i);var m=s&&u?e[g]:g;a+=y(t[l][m],g)}l<t.length-1&&(!r||0<f&&!d)&&(a+=o)}}return a}function y(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);!0===f&&"string"==typeof e&&null!==e.match(/^[=+\-@].*$/)&&(e="'"+e);var n=e.toString().replace(h,u),o="boolean"==typeof r&&r||"function"==typeof r&&r(e,t)||Array.isArray(r)&&r[t]||function(e,t){for(var r=0;r<t.length;r++)if(-1<e.indexOf(t[r]))return!0;return!1}(n,a.BAD_DELIMITERS)||-1<n.indexOf(i)||" "===n.charAt(0)||" "===n.charAt(n.length-1);return o?s+n+s:n}}};if(a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\ufeff",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!r&&!!t.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=y,a.ParserHandle=d,a.NetworkStreamer=c,a.FileStreamer=l,a.StringStreamer=f,a.ReadableStreamStreamer=h,t.jQuery){var s=t.jQuery;s.fn.parse=function(e){var r=e.config||{},n=[];return this.each((function(e){if("INPUT"!==s(this).prop("tagName").toUpperCase()||"file"!==s(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)n.push({file:this.files[i],inputElem:this,instanceConfig:s.extend({},r)})})),i(),this;function i(){if(0!==n.length){var t,r,i,u=n[0];if(b(e.before)){var c=e.before(u.file,u.inputElem);if("object"==typeof c){if("abort"===c.action)return"AbortError",t=u.file,r=u.inputElem,i=c.reason,void(b(e.error)&&e.error({name:"AbortError"},t,r,i));if("skip"===c.action)return void o();"object"==typeof c.config&&(u.instanceConfig=s.extend(u.instanceConfig,c.config))}else if("skip"===c)return void o()}var l=u.instanceConfig.complete;u.instanceConfig.complete=function(e){b(l)&&l(e,u.file,u.inputElem),o()},a.parse(u.file,u.instanceConfig)}else b(e.complete)&&e.complete()}function o(){n.splice(0,1),i()}}}function u(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=m(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new d(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,r){if(this.isFirstChunk&&b(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(e);void 0!==i&&(e=i)}this.isFirstChunk=!1,this._halted=!1;var o=this._partialLine+e;this._partialLine="";var s=this._handle.parse(o,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var u=s.meta.cursor;this._finished||(this._partialLine=o.substring(u-this._baseIndex),this._baseIndex=u),s&&s.data&&(this._rowCount+=s.data.length);var c=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(n)t.postMessage({results:s,workerId:a.WORKER_ID,finished:c});else if(b(this._config.chunk)&&!r){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);s=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),this._completed||!c||!b(this._config.complete)||s&&s.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),c||s&&s.meta.paused||this._nextChunk(),s}this._halted=!0},this._sendError=function(e){b(this._config.error)?this._config.error(e):n&&this._config.error&&t.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function c(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),u.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),r||(t.onload=w(this._chunkLoaded,this),t.onerror=w(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var n in e)t.setRequestHeader(n,e[n])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+i)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}r&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substring(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var r=t.statusText||e;this._sendError(new Error(r))}}function l(e){var t,r;(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),u.call(this,e);var n="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,r=e.slice||e.webkitSlice||e.mozSlice,n?((t=new FileReader).onload=w(this._chunkLoaded,this),t.onerror=w(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var i=Math.min(this._start+this._config.chunkSize,this._input.size);e=r.call(e,this._start,i)}var o=t.readAsText(e,this._config.encoding);n||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function f(e){var t;u.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,r=this._config.chunkSize;return r?(e=t.substring(0,r),t=t.substring(r)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function h(e){u.call(this,e=e||{});var t=[],r=!0,n=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){n&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=w((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=w((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=w((function(){this._streamCleanUp(),n=!0,this._streamData("")}),this),this._streamCleanUp=w((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function d(e){var t,r,n,i=Math.pow(2,53),o=-i,s=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,u=/^(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))$/,c=this,l=0,f=0,h=!1,d=!1,v=[],_={data:[],errors:[],meta:{}};if(b(e.step)){var g=e.step;e.step=function(t){if(_=t,O())k();else{if(k(),0===_.data.length)return;l+=t.data.length,e.preview&&l>e.preview?r.abort():(_.data=_.data[0],g(_,c))}}}function w(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function k(){if(_&&n&&(E("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),n=!1),e.skipEmptyLines)for(var t=0;t<_.data.length;t++)w(_.data[t])&&_.data.splice(t--,1);return O()&&function(){if(_)if(Array.isArray(_.data[0])){for(var t=0;O()&&t<_.data.length;t++)_.data[t].forEach(r);_.data.splice(0,1)}else _.data.forEach(r);function r(t,r){b(e.transformHeader)&&(t=e.transformHeader(t,r)),v.push(t)}}(),function(){if(!_||!e.header&&!e.dynamicTyping&&!e.transform)return _;function t(t,r){var n,i=e.header?{}:[];for(n=0;n<t.length;n++){var o=n,a=t[n];e.header&&(o=n>=v.length?"__parsed_extra":v[n]),e.transform&&(a=e.transform(a,o)),a=S(o,a),"__parsed_extra"===o?(i[o]=i[o]||[],i[o].push(a)):i[o]=a}return e.header&&(n>v.length?E("FieldMismatch","TooManyFields","Too many fields: expected "+v.length+" fields but parsed "+n,f+r):n<v.length&&E("FieldMismatch","TooFewFields","Too few fields: expected "+v.length+" fields but parsed "+n,f+r)),i}var r=1;return!_.data.length||Array.isArray(_.data[0])?(_.data=_.data.map(t),r=_.data.length):_.data=t(_.data,0),e.header&&_.meta&&(_.meta.fields=v),f+=r,_}()}function O(){return e.header&&0===v.length}function S(t,r){return n=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[n]&&(e.dynamicTyping[n]=e.dynamicTypingFunction(n)),!0===(e.dynamicTyping[n]||e.dynamicTyping)?"true"===r||"TRUE"===r||"false"!==r&&"FALSE"!==r&&(function(e){if(s.test(e)){var t=parseFloat(e);if(o<t&&t<i)return!0}return!1}(r)?parseFloat(r):u.test(r)?new Date(r):""===r?null:r):r;var n}function E(e,t,r,n){var i={type:e,code:t,message:r};void 0!==n&&(i.row=n),_.errors.push(i)}this.parse=function(i,o,s){var u=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var r=new RegExp(p(t)+"([^]*?)"+p(t),"gm"),n=(e=e.replace(r,"")).split("\r"),i=e.split("\n"),o=1<i.length&&i[0].length<n[0].length;if(1===n.length||o)return"\n";for(var a=0,s=0;s<n.length;s++)"\n"===n[s][0]&&a++;return a>=n.length/2?"\r\n":"\r"}(i,u)),n=!1,e.delimiter)b(e.delimiter)&&(e.delimiter=e.delimiter(i),_.meta.delimiter=e.delimiter);else{var c=function(t,r,n,i,o){var s,u,c,l;o=o||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var f=0;f<o.length;f++){var h=o[f],d=0,p=0,v=0;c=void 0;for(var _=new y({comments:i,delimiter:h,newline:r,preview:10}).parse(t),g=0;g<_.data.length;g++)if(n&&w(_.data[g]))v++;else{var m=_.data[g].length;p+=m,void 0!==c?0<m&&(d+=Math.abs(m-c),c=m):c=m}0<_.data.length&&(p/=_.data.length-v),(void 0===u||d<=u)&&(void 0===l||l<p)&&1.99<p&&(u=d,s=h,l=p)}return{successful:!!(e.delimiter=s),bestDelimiter:s}}(i,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);c.successful?e.delimiter=c.bestDelimiter:(n=!0,e.delimiter=a.DefaultDelimiter),_.meta.delimiter=e.delimiter}var l=m(e);return e.preview&&e.header&&l.preview++,t=i,r=new y(l),_=r.parse(t,o,s),k(),h?{meta:{paused:!0}}:_||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,r.abort(),t=b(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){c.streamer._halted?(h=!1,c.streamer.parseChunk(t,!0)):setTimeout(c.resume,3)},this.aborted=function(){return d},this.abort=function(){d=!0,r.abort(),_.meta.aborted=!0,b(e.complete)&&e.complete(_),t=""}}function p(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y(e){var t,r=(e=e||{}).delimiter,n=e.newline,i=e.comments,o=e.step,s=e.preview,u=e.fastMode,c=t=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(c=e.escapeChar),("string"!=typeof r||-1<a.BAD_DELIMITERS.indexOf(r))&&(r=","),i===r)throw new Error("Comment character same as delimiter");!0===i?i="#":("string"!=typeof i||-1<a.BAD_DELIMITERS.indexOf(i))&&(i=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var l=0,f=!1;this.parse=function(e,a,h){if("string"!=typeof e)throw new Error("Input must be a string");var d=e.length,y=r.length,v=n.length,_=i.length,g=b(o),m=[],w=[],k=[],O=l=0;if(!e)return L();if(u||!1!==u&&-1===e.indexOf(t)){for(var S=e.split(n),E=0;E<S.length;E++){if(k=S[E],l+=k.length,E!==S.length-1)l+=n.length;else if(h)return L();if(!i||k.substring(0,_)!==i){if(g){if(m=[],j(k.split(r)),z(),f)return L()}else j(k.split(r));if(s&&s<=E)return m=m.slice(0,s),L(!0)}}return L()}for(var C=e.indexOf(r,l),T=e.indexOf(n,l),x=new RegExp(p(c)+p(t),"g"),R=e.indexOf(t,l);;)if(e[l]!==t)if(i&&0===k.length&&e.substring(l,l+_)===i){if(-1===T)return L();l=T+v,T=e.indexOf(n,l),C=e.indexOf(r,l)}else if(-1!==C&&(C<T||-1===T))k.push(e.substring(l,C)),l=C+y,C=e.indexOf(r,l);else{if(-1===T)break;if(k.push(e.substring(l,T)),D(T+v),g&&(z(),f))return L();if(s&&m.length>=s)return L(!0)}else for(R=l,l++;;){if(-1===(R=e.indexOf(t,R+1)))return h||w.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:m.length,index:l}),I();if(R===d-1)return I(e.substring(l,R).replace(x,t));if(t!==c||e[R+1]!==c){if(t===c||0===R||e[R-1]!==c){-1!==C&&C<R+1&&(C=e.indexOf(r,R+1)),-1!==T&&T<R+1&&(T=e.indexOf(n,R+1));var P=A(-1===T?C:Math.min(C,T));if(e[R+1+P]===r){k.push(e.substring(l,R).replace(x,t)),e[l=R+1+P+y]!==t&&(R=e.indexOf(t,l)),C=e.indexOf(r,l),T=e.indexOf(n,l);break}var M=A(T);if(e.substring(R+1+M,R+1+M+v)===n){if(k.push(e.substring(l,R).replace(x,t)),D(R+1+M+v),C=e.indexOf(r,l),R=e.indexOf(t,l),g&&(z(),f))return L();if(s&&m.length>=s)return L(!0);break}w.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:m.length,index:l}),R++}}else R++}return I();function j(e){m.push(e),O=l}function A(t){var r=0;if(-1!==t){var n=e.substring(R+1,t);n&&""===n.trim()&&(r=n.length)}return r}function I(t){return h||(void 0===t&&(t=e.substring(l)),k.push(t),l=d,j(k),g&&z()),L()}function D(t){l=t,j(k),k=[],T=e.indexOf(n,l)}function L(e){return{data:m,errors:w,meta:{delimiter:r,linebreak:n,aborted:f,truncated:!!e,cursor:O+(a||0)}}}function z(){o(L()),m=[],w=[]}},this.abort=function(){f=!0},this.getCharIndex=function(){return l}}function v(e){var t=e.data,r=i[t.workerId],n=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var o={abort:function(){n=!0,_(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:g,resume:g};if(b(r.userStep)){for(var a=0;a<t.results.data.length&&(r.userStep({data:t.results.data[a],errors:t.results.errors,meta:t.results.meta},o),!n);a++);delete t.results}else b(r.userChunk)&&(r.userChunk(t.results,o,t.file),delete t.results)}t.finished&&!n&&_(t.workerId,t.results)}function _(e,t){var r=i[e];b(r.userComplete)&&r.userComplete(t),r.terminate(),delete i[e]}function g(){throw new Error("Not implemented.")}function m(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=m(e[r]);return t}function w(e,t){return function(){e.apply(t,arguments)}}function b(e){return"function"==typeof e}return n&&(t.onmessage=function(e){var r=e.data;if(void 0===a.WORKER_ID&&r&&(a.WORKER_ID=r.workerId),"string"==typeof r.input)t.postMessage({workerId:a.WORKER_ID,results:a.parse(r.input,r.config),finished:!0});else if(t.File&&r.input instanceof File||r.input instanceof Object){var n=a.parse(r.input,r.config);n&&t.postMessage({workerId:a.WORKER_ID,results:n,finished:!0})}}),(c.prototype=Object.create(u.prototype)).constructor=c,(l.prototype=Object.create(u.prototype)).constructor=l,(f.prototype=Object.create(f.prototype)).constructor=f,(h.prototype=Object.create(u.prototype)).constructor=h,a},void 0===(n=r.apply(t,[]))||(e.exports=n)},660:(e,t,r)=>{var n;!function(e){!function(t){var n="object"==typeof r.g?r.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=o(e);function o(e,t){return function(r,n){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}void 0===n.Reflect?n.Reflect=e:i=o(n.Reflect,i),function(e){var t=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!o&&!a,u={create:o?function(){return D(Object.create(null))}:a?function(){return D({__proto__:null})}:function(){return D({})},has:s?function(e,r){return t.call(e,r)}:function(e,t){return t in e},get:s?function(e,r){return t.call(e,r)?e[r]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),l="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,f=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,o)},t.prototype.entries=function(){return new r(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}():Map,h=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function e(){this._map=new f}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}():Set,d=new(l||"function"!=typeof WeakMap?function(){var e=u.create(),r=n();return function(){function e(){this._key=n()}return e.prototype.has=function(e){var t=i(e,!1);return void 0!==t&&u.has(t,this._key)},e.prototype.get=function(e){var t=i(e,!1);return void 0!==t?u.get(t,this._key):void 0},e.prototype.set=function(e,t){return i(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=i(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=n()},e}();function n(){var t;do{t="@@WeakMap@@"+a()}while(u.has(e,t));return e[t]=!0,t}function i(e,n){if(!t.call(e,r)){if(!n)return;Object.defineProperty(e,r,{value:u.create()})}return e[r]}function o(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function a(){var e,t=(e=16,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):o(new Uint8Array(e),e):o(new Array(e),e));t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<16;++n){var i=t[n];4!==n&&6!==n&&8!==n||(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}():WeakMap);function p(e,t,r){var n=d.get(e);if(O(n)){if(!r)return;n=new f,d.set(e,n)}var i=n.get(t);if(O(i)){if(!r)return;i=new f,n.set(t,i)}return i}function y(e,t,r){if(v(e,t,r))return!0;var n=I(t);return!S(n)&&y(e,n,r)}function v(e,t,r){var n=p(t,r,!1);return!O(n)&&!!n.has(e)}function _(e,t,r){if(v(e,t,r))return g(e,t,r);var n=I(t);return S(n)?void 0:_(e,n,r)}function g(e,t,r){var n=p(t,r,!1);if(!O(n))return n.get(e)}function m(e,t,r,n){p(r,n,!0).set(e,t)}function w(e,t){var r=b(e,t),n=I(e);if(null===n)return r;var i=w(n,t);if(i.length<=0)return r;if(r.length<=0)return i;for(var o=new h,a=[],s=0,u=r;s<u.length;s++){var c=u[s];o.has(c)||(o.add(c),a.push(c))}for(var l=0,f=i;l<f.length;l++)c=f[l],o.has(c)||(o.add(c),a.push(c));return a}function b(e,t){var r=[],n=p(e,t,!1);if(O(n))return r;for(var o=function(e){var t=M(e,i);if(!R(t))throw new TypeError;var r=t.call(e);if(!E(r))throw new TypeError;return r}(n.keys()),a=0;;){var s=j(o);if(!s)return r.length=a,r;var u=s.value;try{r[a]=u}catch(e){try{A(o)}finally{throw e}}a++}}function k(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function O(e){return void 0===e}function S(e){return null===e}function E(e){return"object"==typeof e?null!==e:"function"==typeof e}function C(e,t){switch(k(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",i=M(e,n);if(void 0!==i){var o=i.call(e,r);if(E(o))throw new TypeError;return o}return function(e,t){if("string"===t){var r=e.toString;if(R(r)&&!E(i=r.call(e)))return i;if(R(n=e.valueOf)&&!E(i=n.call(e)))return i}else{var n;if(R(n=e.valueOf)&&!E(i=n.call(e)))return i;var i,o=e.toString;if(R(o)&&!E(i=o.call(e)))return i}throw new TypeError}(e,"default"===r?"number":r)}function T(e){var t=C(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function x(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function R(e){return"function"==typeof e}function P(e){return"function"==typeof e}function M(e,t){var r=e[t];if(null!=r){if(!R(r))throw new TypeError;return r}}function j(e){var t=e.next();return!t.done&&t}function A(e){var t=e.return;t&&t.call(e)}function I(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c)return t;if(t!==c)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var i=n.constructor;return"function"!=typeof i||i===e?t:i}function D(e){return e.__=void 0,delete e.__,e}e("decorate",(function(e,t,r,n){if(O(r)){if(!x(e))throw new TypeError;if(!P(t))throw new TypeError;return function(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!O(n)&&!S(n)){if(!P(n))throw new TypeError;t=n}}return t}(e,t)}if(!x(e))throw new TypeError;if(!E(t))throw new TypeError;if(!E(n)&&!O(n)&&!S(n))throw new TypeError;return S(n)&&(n=void 0),function(e,t,r,n){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,r,n);if(!O(o)&&!S(o)){if(!E(o))throw new TypeError;n=o}}return n}(e,t,r=T(r),n)})),e("metadata",(function(e,t){return function(r,n){if(!E(r))throw new TypeError;if(!O(n)&&!function(e){switch(k(e)){case 3:case 4:return!0;default:return!1}}(n))throw new TypeError;m(e,t,r,n)}})),e("defineMetadata",(function(e,t,r,n){if(!E(r))throw new TypeError;return O(n)||(n=T(n)),m(e,t,r,n)})),e("hasMetadata",(function(e,t,r){if(!E(t))throw new TypeError;return O(r)||(r=T(r)),y(e,t,r)})),e("hasOwnMetadata",(function(e,t,r){if(!E(t))throw new TypeError;return O(r)||(r=T(r)),v(e,t,r)})),e("getMetadata",(function(e,t,r){if(!E(t))throw new TypeError;return O(r)||(r=T(r)),_(e,t,r)})),e("getOwnMetadata",(function(e,t,r){if(!E(t))throw new TypeError;return O(r)||(r=T(r)),g(e,t,r)})),e("getMetadataKeys",(function(e,t){if(!E(e))throw new TypeError;return O(t)||(t=T(t)),w(e,t)})),e("getOwnMetadataKeys",(function(e,t){if(!E(e))throw new TypeError;return O(t)||(t=T(t)),b(e,t)})),e("deleteMetadata",(function(e,t,r){if(!E(t))throw new TypeError;O(r)||(r=T(r));var n=p(t,r,!1);if(O(n))return!1;if(!n.delete(e))return!1;if(n.size>0)return!0;var i=d.get(t);return i.delete(r),i.size>0||d.delete(t),!0}))}(i)}()}(n||(n={}))},590:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n};Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=t.deserialize=t.Serializable=t.JsonProperty=void 0,r(660);var o,a="api:map:",s=a+"serializable",u="design:type";function c(e){var t=Reflect.getPrototypeOf(e);return t&&t.name?i(c(t),[t.name]):[]}function l(e,t){var r={};return e.forEach((function(e){r=n(n({},r),Reflect.getMetadata(""+a+e,t))})),r}function f(e){return Reflect.hasOwnMetadata(s,e)}function h(e,t,r,n){if(null==e)return t;if(e=e.toLowerCase(),(typeof t).toLowerCase()===e)return t;var i=function(){console.error("Type '"+typeof t+"' is not assignable to type '"+e+"' for property '"+r+"' in '"+n+"'.\n","Received: "+JSON.stringify(t))};switch(e){case o.String:var a=t.toString();return"[object Object]"===a?void i():a;case o.Number:var s=+t;return isNaN(s)?void i():s;case o.Boolean:return void i();case o.Date:return isNaN(Date.parse(t))?void i():new Date(t);default:return t}}!function(e){e.Array="array",e.Boolean="boolean",e.Date="date",e.Number="number",e.Object="object",e.String="string"}(o||(o={})),t.JsonProperty=function(e){return function(t,r,i){if(void 0===r&&t.prototype){var s=Reflect.getMetadata("design:paramtypes",t)[i],c=function(e){var t=e.toString().replace(/(\/\*[\s\S]*?\*\/|\/\/.*$)/gm,"").replace(/[\r\t\n\v\f]/g,"").replace(/( +)/g," "),r=/(?:this\.)([^\n\r\t\f\v;]+)([\s;])/gm,n=new Map,i=/(?:.*(?:constructor|function).*?(?=\())(?:\()(.+?(?=\)))/m.exec(t);if(!i||!i.length)return n;for(var o,a=i[1].replace(/ /g,"").split(","),s=function(){var e=o[1].replace(/ /g,"").split("="),t=a.findIndex((function(t){return t===e[1]}));t>-1&&n.set(t,e[0])};o=r.exec(t);)s();return n}(t.prototype.constructor);r=c.get(i),t=t.prototype,Reflect.defineMetadata(u,s,t,r)}var l={},f=t.constructor.name,h=""+a+f;Reflect.hasMetadata(h,t)&&(l=Reflect.getMetadata(h,t)),l[r]=function(e,t){return t?(r=typeof t===o.String?{name:t,isNameOverridden:!0}:t.name?{name:t.name,isNameOverridden:!0}:t.names&&t.names.length?{names:t.names}:{name:e.toString(),isNameOverridden:!1},t.predicate?n(n({},r),{predicate:t.predicate,onDeserialize:t.onDeserialize,onSerialize:t.onSerialize,postDeserialize:t.postDeserialize,isDictionary:!!t.isDictionary}):n(n({},r),{type:t.type,onDeserialize:t.onDeserialize,onSerialize:t.onSerialize,postDeserialize:t.postDeserialize,isDictionary:!!t.isDictionary})):{name:e.toString(),isDictionary:!1,isNameOverridden:!1};var r}(r,e),Reflect.defineMetadata(h,l,t)}},t.Serializable=function(e){return function(t){var r=c(t);Reflect.defineMetadata(s,{baseClassNames:r,options:e},t)}},t.deserialize=function e(t,r){var i;if([null,void 0].includes(t))return t;if(void 0===r)return h(typeof t,t);var c=new r,d=c.constructor.name,p=null!==(i=Reflect.getMetadata(s,r))&&void 0!==i?i:{},y=p.baseClassNames,v=p.options,_=""+a+d,g=Reflect.hasMetadata(_,c),m={};return g||y&&y.length?(m=Reflect.getMetadata(_,c),y&&y.length&&(m=n(n({},l(y,c)),m)),Object.keys(m).forEach((function(r){var n=function(t,r,n,i,a){var s;if([null,void 0].includes(i))return i;if("names"in n){var c={};n.names.forEach((function(e){return c[e]=i[e]})),s=c}else if("name"in n&&!n.isNameOverridden&&a){var l=a(n.name);s=i[l]}else s=i[n.name];if([null,void 0].includes(s))return s;var d,p=Reflect.getMetadata(u,t,r),y=!!p.name&&p.name.toLowerCase()===o.Array,v=n.isDictionary,_=n.predicate,g=n.onDeserialize,m=n.postDeserialize,w=n.type||p,b=f(w);if(g&&(s=g(s,t)),v){var k={};typeof s!==o.Object?(console.error("Type '"+typeof s+"' is not assignable to type 'Dictionary' for property '"+r+"' in '"+t.constructor.name+"'.\n","Received: "+JSON.stringify(s)),d=void 0):(Object.keys(s).forEach((function(n){b||_?(_&&(w=_(s[n])),k[n]=e(s[n],w)):k[n]=h(typeof s[n],s[n],r,t.constructor.name)})),d=k)}else if(y){var O=[];Array.isArray(s)?(s.forEach((function(n){b||_?(_&&(w=_(n)),O.push(e(n,w))):O.push(h(typeof n,n,r,t.constructor.name))})),d=O):(console.error("Type '"+typeof s+"' is not assignable to type 'Array' for property '"+r+"' in '"+t.constructor.name+"'.\n","Received: "+JSON.stringify(s)),d=void 0)}else b||_?(w=_?_(s):w,d=e(s,w)):d=h(w.name,s,r,t.constructor.name);return m&&(d=m(d,t)),d}(c,r,m[r],t,null==v?void 0:v.formatPropertyNames);void 0!==n&&(c[r]=n)})),c):c},t.serialize=function e(t,r){var i;if(void 0===r&&(r=!0),[void 0,null].includes(t)||typeof t!==o.Object)return t;var c=t.constructor.name,h=""+a+c,d=null!==(i=Reflect.getMetadata(s,t.constructor))&&void 0!==i?i:{},p=d.baseClassNames,y=d.options,v=p&&p.length,_=Reflect.hasMetadata(h,t),g={};if(!_&&!v)return t;g=Reflect.getMetadata(h,t),v&&(g=n(n({},l(p,t)),g));var m={},w=Object.keys(t);return Object.keys(g).forEach((function(n){var i=g[n].onSerialize;if(w.includes(n)){var a=g[n],s=function(t,r,n,i){var a=t[r],s=Reflect.getMetadata(u,t,r),c=!!s.name&&s.name.toLocaleLowerCase()===o.Array,l=n.predicate,h=n.type||s,d=f(h);if(a&&(d||l)){if(c){var p=[];return a.forEach((function(t){p.push(e(t,i))})),p}if(n.isDictionary){var y={};return Object.keys(a).forEach((function(t){y[t]=e(a[t],i)})),y}return e(a,i)}return h.name.toLocaleLowerCase()===o.Date&&a?a.toISOString():a}(t,n,a,r);if(i&&(s=i(s,t)),a.names)a.names.forEach((function(e){(!r||r&&void 0!==s[e])&&(m[e]=s[e])}));else if(!r||r&&void 0!==s)if(!a.isNameOverridden&&(null==y?void 0:y.formatPropertyNames)){var c=y.formatPropertyNames(a.name);m[c]=s}else m[a.name]=s}})),m}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";var e,t,n,i=r(590),o=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},a=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function s(e,t,r,i,o,a,s){if(e&&t.length){e.textBaseline="top";var u=e.measureText(t),c=u.width,l=u.actualBoundingBoxDescent-u.actualBoundingBoxAscent;s==n.Center?e.fillText(t,r+Math.max((o-c)/2,0),i+(a-l)/2,o):s==n.Left?e.fillText(t,r,i+(a-l)/2,o):s==n.Right&&e.fillText(t,r+o-c,i+(a-l)/2,o)}}function u(e,t,r,i,o,a){var s=i;if(e&&t.length){var u=[],c=[];e.textBaseline="top";var l=0,f=e.measureText(" ").width,h=e.measureText(t),d=1.5*(h.actualBoundingBoxDescent-h.actualBoundingBoxAscent);t.split("\n").forEach((function(t){c.length=0,l=0,t.split(" ").forEach((function(t){var r=e.measureText(t);l+r.width>o&&(u.push(c.join(" ")),c.length=0,l=0),l+=r.width+f,c.push(t)})),c.length>0&&u.push(c.join(" "))}));for(var p=0,y=u;p<y.length;p++){var v=y[p],_=e.measureText(v).width;a==n.Center?e.fillText(v,r+Math.max((o-_)/2,0),s,o):a==n.Left?e.fillText(v,r,s,o):a==n.Right&&e.fillText(v,r+o-_,s,o),s+=d}}return s}!function(e){e.Stratagem="Stratagem",e.PsychicPower="Psychic Power",e.TacticalObjective="Tactical Objective",e.Prayer="Prayer"}(e||(e={})),function(e){e.Classic="Classic",e.Edition_9th="9th Edition"}(t||(t={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center"}(n||(n={}));var c=function(){function r(){this._width=c.defaultWidthPx,this._height=c.defaultHeightPx,this._scale=1,this._type=e.Stratagem,this._style=t.Classic,this._heading="Stratagem",this._title="<Title>",this._fluff="<Fluff text>",this._rule="<Rule text>",this._footer="<Footer>",this._value="1"}var c;return c=r,r.prototype.headerFont=function(){return this._style==t.Edition_9th?Math.round(16*this._scale).toString()+"px Teko":Math.round(24*this._scale).toString()+"px Teko"},r.prototype.titleFont=function(){return Math.round(26*this._scale).toString()+"px Teko"},r.prototype.fluffFont=function(){return"italic "+Math.round(13*this._scale).toString()+"px serif"},r.prototype.ruleFont=function(){return Math.round(15*this._scale).toString()+"px serif"},r.prototype.footFont=function(){return Math.round(18*this._scale).toString()+"px Teko"},r.prototype.valueFont=function(){return Math.round(24*this._scale).toString()+"px Teko"},r.prototype.footerFont=function(){return Math.round(24*this._scale).toString()+"px Teko"},r.prototype.draw=function(r,i){var o=r.getContext("2d");if(o){this._width=r.width-2*i,this._height=r.height-2*i,this._scale=Math.max(this._width/c.defaultWidthPx,this._height/c.defaultHeightPx),o.clearRect(0,0,r.width,r.height),o.translate(i,i),o.lineJoin="round",o.strokeStyle="silver",this.roundRect(o,1,1,this._width-2,this._height-2,20,!1,!0);var a=.05*this._width,l=.02*this._height,f=this._width-2*a,h=this._height-2*l,d=Math.ceil(.3*a),p=12;this._style==t.Edition_9th&&(p=20);var y=this._height/p;this._style==t.Classic&&(o.save(),o.strokeStyle="grey",o.lineWidth=d,this.drawBorder(o,a,l,f,h,y),o.restore());var v=this._heading.toLocaleUpperCase();o.save(),o.font=this.headerFont(),o.textBaseline="top",o.fillStyle="black",s(o,v,a,l,f,y,n.Center),o.restore();var _=2*l+y,g=2*a,m=this._width-2*a,w=m-g;o.moveTo(g,_),o.lineTo(m,_),o.stroke();var b=this._title.toLocaleUpperCase();o.save(),o.font=this.titleFont(),o.textBaseline="top",o.fillStyle="black",s(o,b,g,_,w,y,n.Center),o.restore(),_+=y,this._style==t.Classic?(o.moveTo(g,_),o.lineTo(m,_),o.stroke(),_+=l):_+=l,this._fluff.length>0&&(o.save(),o.font=this.fluffFont(),o.fillStyle="black",_=u(o,this._fluff,g,_,w,n.Center),o.restore(),_+=y/2),o.moveTo(g,_),o.lineTo(m,_),o.stroke(),_+=y/2,o.save(),o.font=this.ruleFont(),o.fillStyle="black",_=u(o,this._rule,g,_,w,n.Center),o.restore(),_=this._height-1.5*l-y,this._type==e.Stratagem||this._type==e.PsychicPower||this._type==e.TacticalObjective?this._style==t.Classic?this.drawFooterClassic(o,g,m,_,y,w):this._style==t.Edition_9th&&this.drawFooter9th(o,g,m,_,y,w):(this._type,e.Prayer)}},r.prototype.toString=function(){return"Card: "+this._type.toString()+"  Title: "+this._title+"  Rule: "+this._rule+"  CP: "+this._value},r.prototype.roundRect=function(e,t,r,n,i,o,a,s){e.beginPath(),e.moveTo(t+o,r),e.lineTo(t+n-o,r),e.quadraticCurveTo(t+n,r,t+n,r+o),e.lineTo(t+n,r+i-o),e.quadraticCurveTo(t+n,r+i,t+n-o,r+i),e.lineTo(t+o,r+i),e.quadraticCurveTo(t,r+i,t,r+i-o),e.lineTo(t,r+o),e.quadraticCurveTo(t,r,t+o,r),e.closePath(),a&&e.fill(),s&&e.stroke()},r.prototype.bevelRect=function(e,t,r,n,i,o,a,s){e.beginPath(),e.moveTo(t,r+o),e.lineTo(t,r+i-o),e.lineTo(t+o,r+i),e.lineTo(t+n-o,r+i),e.lineTo(t+n,r+i-o),e.lineTo(t+n,r+o),e.lineTo(t+n-o,r),e.lineTo(t+o,r),e.closePath(),a&&e.fill(),s&&e.stroke()},r.prototype.drawBorder=function(e,t,r,n,i,o){this.bevelRect(e,t,r,n,i,o,!1,!0),e.moveTo(t,r+o),e.lineTo(t+n,r+o),e.stroke()},r.prototype.drawFooterClassic=function(t,r,i,o,a,u){var c=a;t.save(),t.lineWidth=Math.max(Math.ceil(this._scale),1),this.roundRect(t,2*r+c,o,u-2*r-c,a-6,8,!1,!0),t.restore(),t.save(),t.font=this.footFont(),t.textBaseline="top",t.fillStyle="black";var l="COMMAND POINTS";this._type===e.Stratagem?"1"==this._value&&(l="COMMAND POINT"):this._type===e.PsychicPower?l="WARP CHARGE":this._type===e.TacticalObjective&&(l=this._footer),s(t,l,2*r+c,o,u-2*r-c,a-6,n.Center),t.restore(),t.save(),t.fillStyle="#ba2222",t.lineWidth=Math.max(Math.ceil(this._scale),1),this.bevelRect(t,2*r,o-3,c,c,5,!0,!0),t.restore(),t.save(),t.font=this.valueFont(),t.textBaseline="top",t.fillStyle="#f5f2f2",s(t,this._value,2*r,o-3,c,c,n.Center),t.restore()},r.prototype.drawFooter9th=function(t,r,i,o,a,u){var c="";this._type===e.Stratagem?(c=this._value+" COMMAND POINT","1"!=this._value&&(c+="S")):this._type===e.PsychicPower?c="WARP CHARGE "+this._value:this._type===e.TacticalObjective&&(c=this._footer),c.length>0&&(t.moveTo(r,o),t.lineTo(i,o),t.stroke(),o+=4,t.save(),t.font=this.footFont(),t.textBaseline="top",t.fillStyle="black",s(t,c,r,o,u,a,n.Center),t.restore())},r.defaultWidthPx=400,r.defaultHeightPx=560,o([(0,i.JsonProperty)(),a("design:type",Number)],r.prototype,"_width",void 0),o([(0,i.JsonProperty)(),a("design:type",Number)],r.prototype,"_height",void 0),o([(0,i.JsonProperty)(),a("design:type",Object)],r.prototype,"_scale",void 0),o([(0,i.JsonProperty)(),a("design:type",String)],r.prototype,"_type",void 0),o([(0,i.JsonProperty)(),a("design:type",String)],r.prototype,"_style",void 0),o([(0,i.JsonProperty)(),a("design:type",Object)],r.prototype,"_heading",void 0),o([(0,i.JsonProperty)(),a("design:type",Object)],r.prototype,"_title",void 0),o([(0,i.JsonProperty)(),a("design:type",Object)],r.prototype,"_fluff",void 0),o([(0,i.JsonProperty)(),a("design:type",Object)],r.prototype,"_rule",void 0),o([(0,i.JsonProperty)(),a("design:type",Object)],r.prototype,"_footer",void 0),o([(0,i.JsonProperty)(),a("design:type",Object)],r.prototype,"_value",void 0),c=o([(0,i.Serializable)()],r)}(),l=r(460),f=[],h=0;function d(){var e=document.getElementById("preview");e&&f[h]&&f[h].draw(e,0)}function p(e){return e/25.4}function y(e){return"CLASSIC"==e?t.Classic:t.Edition_9th}function v(){f[h]&&($("#cardtype").val(f[h]._type.toString()),$("#cardstyle").val(f[h]._style.toString()),$("#cardheader").val(f[h]._heading),$("#cardtitle").val(f[h]._title),$("#cardrule").val(f[h]._rule),$("#cardfluff").val(f[h]._fluff),$("#cardfooter").val(f[h]._footer),$("#cardfootercontrol").hide(),f[h]._type===e.Stratagem?($("#cardvalue").attr({min:1,max:3}),parseInt(f[h]._value)>3?f[h]._value="3":parseInt(f[h]._value)<1&&(f[h]._value="1"),$("#cardvaluelabel").html("Command Points"),$("#cardvaluecontrol").show()):f[h]._type===e.PsychicPower?($("#cardvalue").attr({min:2,max:12}),parseInt(f[h]._value)>12?f[h]._value="12":parseInt(f[h]._value)<2&&(f[h]._value="2"),$("#cardvaluelabel").html("Warp Charge"),$("#cardvaluecontrol").show()):f[h]._type===e.TacticalObjective?f[h]._style==t.Classic?($("#cardvalue").attr({min:11,max:66}),parseInt(f[h]._value)>66?f[h]._value="66":parseInt(f[h]._value)<11&&(f[h]._value="11"),$("#cardvaluelabel").html("Objective (D66)"),$("#cardvaluecontrol").show()):f[h]._style==t.Edition_9th&&($("#cardvaluecontrol").hide(),$("#cardfootercontrol").show()):f[h]._type===e.Prayer&&$("#cardvaluecontrol").hide(),$("#cardvalue").val(f[h]._value))}console.log("Reloading web page.");var _=document.getElementById("preview");_&&_.getContext("2d")&&0==f.length&&(f[h=0]=new c),$("#previouscard").click((function(){h=Math.max(h-1,0),v(),d()})),$("#nextcard").click((function(){h=Math.min(h+1,f.length-1),v(),d()})),$("#cardtype").on("change",(function(t){var r=t.target;r&&f[h]&&(f[h]._heading=r.selectedOptions[0].text,$("#cardheader").val(f[h]._heading),"Stratagem"==r.selectedOptions[0].text?f[h]._type=e.Stratagem:"Psychic Power"==r.selectedOptions[0].text?f[h]._type=e.PsychicPower:"Tactical Objective"==r.selectedOptions[0].text?f[h]._type=e.TacticalObjective:"Prayer"==r.selectedOptions[0].text&&(f[h]._type=e.Prayer),v(),d())})),$("#cardstyle").on("change",(function(e){var r=e.target;r&&f[h]&&("Classic"==r.selectedOptions[0].text?f[h]._style=t.Classic:"9th Edition"==r.selectedOptions[0].text&&(f[h]._style=t.Edition_9th),v(),d())})),$("#cardheader").on("input",(function(e){var t=e.target;t&&f[h]&&(f[h]._heading=t.value,d())})),$("#cardtitle").on("input",(function(e){var t=e.target;t&&f[h]&&(f[h]._title=t.value,d())})),$("#cardrule").on("input",(function(e){var t=e.target;t&&f[h]&&(f[h]._rule=t.value,d())})),$("#cardfluff").on("input",(function(e){var t=e.target;t&&f[h]&&(f[h]._fluff=t.value,d())})),$("#cardvalue").on("input",(function(e){var t=e.target;t&&f[h]&&(f[h]._value=t.value,d())})),$("#cardfooter").on("input",(function(e){var t=e.target;t&&f[h]&&(f[h]._footer=t.value,d())})),$("#createcard").click((function(){if(f[h]){var e=[63,88],t=300,r=0,n=document.getElementById("outputdpi");n&&(t=parseInt(n.value));var i=document.getElementById("outputmargin");i&&(r=parseInt(i.value));var o=Math.ceil(p(r)*t),a=document.createElement("canvas");a.width=Math.round(p(e[0])*t)+2*o,a.height=Math.round(p(e[1])*t)+2*o,f[h].draw(a,o);var s=document.createElement("a");s.download="stratagem.png",s.href=a.toDataURL("image/png"),s.click(),console.log("Current card: "+h+" Num active cards: "+f.length),v(),d()}})),$("#datacardfile").on("change",(function(r){var n,i=r.target.files,o=t.Edition_9th;if(i){h=0,f.length=0;for(var a=0;a<i.length;a++){var s=i.item(a);if(null!=s){var u=(n=void 0,(n=s.name.split(".")).length>1?n[n.length-1].toLowerCase():"");"csv"===u||"tsv"===u?(0,l.parse)(s,{complete:function(t){for(var r=0,n=t.data;r<n.length;r++){var i=n[r],a=e.Stratagem;if("STRATAGEM"==i[0].toUpperCase())a=e.Stratagem;else if("PSYCHIC POWER"===i[0].toUpperCase())a=e.PsychicPower;else if("TACTICAL OBJECTIVE"===i[0].toUpperCase())a=e.TacticalObjective;else{if("PRAYER"!==i[0].toUpperCase())continue;a=e.Prayer}if(a==e.Prayer){var s=1;(l=new c)._type=a,l._value="",5==i.length?l._style=o:6==i.length&&(l._style=y(i[s++])),l._title=i[s++],l._heading=i[s++],l._fluff=i[s++],l._rule=i[s++],f.push(l)}else if(a==e.TacticalObjective){var u=1;(l=new c)._type=a,5==i.length?l._style=o:i.length>=6&&(l._style=y(i[u++])),l._title=i[u++],l._heading=i[u++],l._fluff=i[u++],l._rule=i[u++],7==i.length?l._footer=i[u++]:l._footer="OBJECTIVE",f.push(l)}else{var l,p=1;(l=new c)._type=a,6==i.length?l._style=o:7==i.length&&(l._style=y(i[p++])),l._value=i[p++],l._title=i[p++],l._heading=i[p++],l._fluff=i[p++],l._rule=i[p++],f.push(l)}}h=0,console.log("Num active cards: "+f.length),v(),d()}}):($("#errorText").html('StrataGen only supports .csv files.  Selected file is a "'+u+'" file.'),$("#errorDialog").modal())}}}})),$("#backgroundfile").on("change",(function(e){var t=e.target.files;t&&t[0]})),$("#bgopacity").on("input",(function(e){var t=e.target;t&&t.value})),$("#bgsaturation").on("input",(function(e){var t=e.target;t&&t.value})),$("#savecard").click((function(){localStorage.setItem("lastCard",JSON.stringify((0,i.serialize)(f[h])))})),$("#loadcard").click((function(){var e=localStorage.getItem("lastCard");e?(f[h]=(0,i.deserialize)(JSON.parse(e),c),v(),d()):console.log("Card not loaded.")})),v(),d(),console.log("Started...")})()})();
//# sourceMappingURL=stratagen.js.map